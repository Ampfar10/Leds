import asyncio
from bleak import BleakClient

# Replace with your LED's Bluetooth MAC address
LED_MAC_ADDRESS = "FF:10:10:98:76:76"  # Example MAC address

# This is an async function that connects to the LED
async def connect_to_led(mac_address):
    async with BleakClient(mac_address) as client:
        # Check if the connection was successful
        if not client.is_connected:
            print(f"‚ùó Failed to connect to {mac_address}")
            return
        
        print(f"üîó Connected to LED at {mac_address}")

        # Discover available services and characteristics
        services = await client.get_services()
        for service in services:
            print(f"Service: {service.uuid}")
            for characteristic in service.characteristics:
                print(f"  Characteristic: {characteristic.uuid} - Properties: {characteristic.properties}")

                # Attempt to read the characteristic value periodically
                if 'read' in characteristic.properties:
                    print(f"  Reading characteristic {characteristic.uuid}")
                    try:
                        while True:
                            data = await client.read_gatt_char(characteristic)
                            print(f"üì• Data from {characteristic.uuid}: {data.hex()}")
                            await asyncio.sleep(1)  # Wait for 1 second before reading again
                    except Exception as e:
                        print(f"‚ùó Failed to read {characteristic.uuid}: {e}")

# Run the async function to connect and listen
asyncio.run(connect_to_led(LED_MAC_ADDRESS))
